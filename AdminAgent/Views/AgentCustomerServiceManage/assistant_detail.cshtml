@model Ydb.Membership.Application.Dto.DZMembershipCustomerServiceDto
@{
    ViewBag.headTitle = "助理管理";
    ViewBag.subTitle = "助理信息";
    ViewBag.breadcrumbOl = new List<string>() { "助理管理", "助理列表", "助理信息" };
}

 <!-- Main content -->
<section class="content">
    <!-- /.row -->
    <div class="row">
        <!-- /.col -->
        <div class="col-xs-12">
            <div class="box box-primary">
                <div class="box-body box-profile">
                    <div class="col-xs-12">
                        <div class="box-header with-border text-center">
                            <h3 class="box-title text-center">@Model.DisplayName<span style="color: #4db2c6">&nbsp;&nbsp;@(Model.IsLocked?"封停中": "活跃中")</span></h3>
                            <div class="box-tools pull-right">
                                <div class="btn-group">
                                    <button type="button" class="btn btn-box-tool dropdown-toggle" data-toggle="dropdown">
                                        <i class="fa fa-wrench"></i>&nbsp;设置
                                    </button>
                                    <ul class="dropdown-menu" role="menu">
                                        <li><a href="#" data-toggle="modal" data-target="#resetPass">重置密码</a></li>
                                        <li class="divider"></li>
                                        <li><a href="#" id="isLook" data-toggle="modal" data-target="#toggleFreeze" data-look=@(Model.IsLocked ? "true" : "false") >@(Model.IsLocked ? "解封助理" : "封停助理")</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-12">
                            <ul class="list-group list-group-unbordered">
                                <li class="list-group-item">
                                    <div class="height20">
                                        <div class="col-xs-6">
                                            <b>姓名：</b> <a class="pull-right">@Model.RealName</a>
                                        </div>
                                        <div class="col-xs-6">
                                            <b>首次登录助理工具时间：</b> <a class="pull-right">@Model.TimeCreated</a>
                                        </div>
                                    </div>
                                </li>
                                <li class="list-group-item">
                                    <div class="height20">
                                        <div class="col-xs-6">
                                            <b>性别：</b> <a class="pull-right">@(Model.Sex ? "女" : "男")</a>
                                        </div>
                                        <div class="col-xs-6">
                                            <b>最近一次上线时间：</b> <a class="pull-right">@Model.LastLoginTime</a>
                                        </div>
                                    </div>
                                </li>
                                <li class="list-group-item">
                                    <div class="height20">
                                        <div class="col-xs-6">
                                            <b>身份证号：</b> <a class="pull-right">@Model.PersonalID</a>
                                        </div>
                                        <div class="col-xs-6">
                                            <b>累计上线时长：</b> <a class="pull-right">@ViewData["totalOnlineTime"]</a>
                                        </div>
                                    </div>
                                </li>
                                <li class="list-group-item">
                                    <div class="height20">
                                        <div class="col-xs-6">
                                            <b>联系电话：</b> <a class="pull-right">@Model.Phone</a>
                                        </div>
                                        <div class="col-xs-6">
                                            <b>注册时间：</b> <a class="pull-right">@Model.TimeCreated</a>
                                        </div>
                                    </div>
                                </li>
                                <li class="list-group-item">
                                    <div class="height20">
                                        <div class="col-xs-6">
                                            <b>QQ号码：</b> <a class="pull-right">@Model.QQNumber</a>
                                        </div>
                                        <div class="col-xs-6">
                                            <b>申请时间：</b> <a class="pull-right">@Model.ApplyTime</a>
                                        </div>
                                    </div>
                                </li>
                                <li class="list-group-item">
                                    <div class="height20">
                                        <div class="col-xs-6">
                                            <b>工作城市：</b> <a class="pull-right">@Model.UserCity</a>
                                        </div>
                                        <div class="col-xs-6">
                                            <b>通过时间：</b> <a class="pull-right">@Model.VerifyTime</a>
                                        </div>
                                    </div>
                                </li>
                                @*<li class="list-group-item">
                                    <div class="height20">
                                        <div class="col-xs-6">
                                            <b>性别：</b> <a class="pull-right">男</a>
                                        </div>
                                        <div class="col-xs-6">
                                            <b>最近一次上线时间：</b> <a class="pull-right">2016.12.02 15:23</a>
                                        </div>
                                    </div>
                                </li>*@
                                <li class="list-group-item">
                                    <div class="height20">
                                        <div class="col-xs-6">
                                            <b>累计接单：</b> <a class="pull-right"><span>@ViewData["totalOrderCount"]</span>单</a>
                                        </div>
                                        <div class="col-xs-6">
                                            <b>收到投诉：</b> <a class="pull-right"><span>5</span>单</a>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <h4 class="box-title col-xs-12">查看聊天记录</h4>
                    <div class="col-xs-12">
                        <div class="form-horizontal col-xs-3 no-padding">
                            <div class="form-group">
                                <div class="col-md-12">
                                    <div class="input-group">
                                        <div class="input-group-addon">
                                            <i class="fa fa-calendar"></i>
                                        </div>
                                        <input type="text" class="form-control pull-right" id="reservation">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tab-content col-xs-12">
                        <div class="tab-pane active" id="tab_1">
                            
                            <!--聊天记录content-->
                            @Html.Action("assistant_detail_message", "AgentCustomerServiceManage", new { id = @ViewData["id"] })
                            @*@Html.Action("assistant_detail_message", "AgentCustomerServiceManage", new { area = @ViewData["id"] })*@

                            

                        </div>
                    </div>
                </div>
                <!-- /.box-body -->
            </div>

        </div>
        <!-- /.col -->
    </div>
    <!-- /.row -->

    <!-- 模态框（Modal） -->
    <div class="modal fade" id="resetPass" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="myModalLabel">重置密码</h4>
                </div>
                <div class="modal-body">确认重置该助理密码</div>
                <div class="modal-footer">
                    <button id="resetPassConf" type="button" class="btn btn-primary">确定</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>
    <!-- 模态框（Modal） -->
    <div class="modal fade" id="toggleFreeze" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="myModalLabel2">@(Model.IsLocked ? "解封账号" : "封停账号")</h4>
                </div>
                <div class="modal-body">确认@(Model.IsLocked ? "解封账号" : "封停账号")</div>
                <div class="modal-footer">
                    <button id="toggleFreezeConf" type="button" class="btn btn-primary">确定</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>

    <!-- 模态框（Modal） -->
    <div class="modal fade" id="notify" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">操作提示</h4>
                </div>
                <div class="modal-body">操作提示</div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal">确定</button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>
</section>
<!-- /.content -->
@Html.Action("footer", "Agent", new { id = "" })

<!-- DataTables -->
<script src="../../static/plugins/datatables/jquery.dataTables.min.js"></script>
<script src="../../static/plugins/datatables/dataTables.bootstrap.min.js"></script>
<!-- date-range-picker -->
<script src="../../static/plugins/daterangepicker/moment.min.js"></script>
<script src="../../static/plugins/daterangepicker/daterangepicker.js"></script>

<script src="../../static/libs/YDBan.lib.js"></script>

<script>
    (function(){
        var url = YDBan.url;
        var notify = $("#notify");

        //Date range picker
        $('#reservation').daterangepicker();
        //Date range picker with time picker
        //初始化定制数据列表
        $(".table-striped").DataTable({
            "order": [[ 0, "asc" ]],
            "language" :{
                "decimal":        "",
                "emptyTable":     "没有数据",
                "info":           "从_START_ 到 _END_ 条记录——总记录数为 _TOTAL_ 条",
                "infoEmpty":      "记录数为0",
                "infoFiltered":   "(全部记录数 _MAX_  条)",
                "infoPostFix":    "",
                "thousands":      ",",
                "lengthMenu":     "显示 _MENU_ 条",
                "loadingRecords": "加载中...",
                "processing":     "处理中...",
                "search":         "查找：",
                "zeroRecords":    "找不到内容",
                "paginate": {
                    "first":      "第一页",
                    "last":       "最后一页",
                    "next":       "下一页",
                    "previous":   "上一页"
                }
            }
        });

        $("#resetPassConf").on("click", function(){
            $.ajax({
                url: "/AgentCustomerServiceManage/assistant_detail_recoverypassword",
                type: "GET",
                data: {
                    id: url.getUrlParam("id")
                },
                dataType: 'json'
            }).done(function(resp, status, xhr){
                if ( status = "success" ){
                    notify.modal('show');
                    notify.find(".modal-body").text("操作成功");
                }
            }).fail(function(resp, status, xhr){
                $("#resetPass").modal('hide');
                notify.find(".modal-body").text("操作失败，请重试");
                notify.modal('show');
            })
        });

        $("#toggleFreezeConf").on("click", function(){
            $.ajax({
                url: "/AgentCustomerServiceManage/assistant_detail_Lock",
                type: "GET",
                data: {
                    id: url.getUrlParam("id"),
                    isLook : $("#isLook").data("look")
                },
                dataType: 'json'
            }).done(function(resp, status, xhr){
                if ( status = "success" ){
                    notify.modal('show');
                    notify.find(".modal-body").text("操作成功");
                }
            }).fail(function(resp, status, xhr){
                $("#toggleFreeze").modal('hide');
                notify.find(".modal-body").text("操作失败，请重试");
                notify.modal('show');
            })
        });
    })();
</script>

